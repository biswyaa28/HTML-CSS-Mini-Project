<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Laser Defender - Pixel Edition</title>
        <!-- ============================================
             LASER DEFENDER - Retro Minecraft Game
             ============================================
             This is a pixel art space shooter game
             with Minecraft-inspired visuals and UI
             ============================================ -->
        <link
            href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap"
            rel="stylesheet"
        />
        <style>
            /* ============================================
               CSS Reset - Clear default browser spacing
               ============================================ */
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }
            /* ============================================
               Body Styles
               ============================================
               - Dirt brown background with pixel pattern
               - 16x16px crosshatch for Minecraft texture
               - Press Start 2P font for 8-bit look
               - Flexbox centers the game container
               ============================================ */
            body {
                background: linear-gradient(180deg, #1a0f08 0%, #0a0502 100%);
                background-image:
                    repeating-linear-gradient(
                        45deg,
                        rgba(0, 0, 0, 0.1) 0px,
                        rgba(0, 0, 0, 0.1) 8px,
                        transparent 8px,
                        transparent 16px
                    ),
                    repeating-linear-gradient(
                        135deg,
                        rgba(0, 0, 0, 0.1) 0px,
                        rgba(0, 0, 0, 0.1) 8px,
                        transparent 8px,
                        transparent 16px
                    );
                background-size: 16px 16px;
                display: flex;
                justify-content: center;
                align-items: center;
                min-height: 100vh;
                font-family: "Press Start 2P", monospace;
                color: #fff;
                overflow: hidden;
            }

            /* ============================================
               CRT Scanline Effect
               ============================================
               Creates horizontal scanlines like old CRT monitors
               Adds retro arcade feel to the game
               ============================================ */
            body::before {
                content: "";
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: repeating-linear-gradient(
                    0deg,
                    rgba(0, 0, 0, 0.1) 0px,
                    rgba(0, 0, 0, 0.1) 2px,
                    transparent 2px,
                    transparent 4px
                );
                pointer-events: none;
                z-index: 9999;
            }

            /* ============================================
               Game Container
               ============================================
               - Beveled 4px border (top-left light, bottom-right dark)
               - Multiple box shadows create depth effect
               - Centered game area with Minecraft-style frame
               ============================================ */
            #gameContainer {
                position: relative;
                border: 4px solid;
                border-color: #8b8b8b #3a3a3a #3a3a3a #8b8b8b;
                box-shadow:
                    0 0 0 4px #1a1a1a,
                    0 0 0 8px #2d2d2d,
                    8px 8px 0 rgba(0, 0, 0, 0.5);
            }

            /* ============================================
               Canvas
               ============================================
               - Pixelated rendering for crisp 8-bit graphics
               - Dark green gradient background
               - Main game rendering area (600x800)
               ============================================ */
            canvas {
                display: block;
                image-rendering: pixelated;
                background: linear-gradient(180deg, #0f1a0f 0%, #081008 100%);
            }

            /* UI Panel */
            /* ============================================
               UI Panel
               ============================================
               - Beveled 3px border
               - Semi-transparent dark background
               - Contains score and lives display
               ============================================ */
            #ui {
                position: absolute;
                top: 10px;
                left: 10px;
                z-index: 10;
            }

            .ui-panel {
                background: #1a1a1a;
                border: 3px solid;
                border-color: #8b8b8b #3a3a3a #3a3a3a #8b8b8b;
                padding: 10px 15px;
                margin-bottom: 8px;
                box-shadow: 2px 2px 0 rgba(0, 0, 0, 0.5);
            }

            .ui-label {
                font-size: 10px;
                color: #8b8b8b;
                margin-bottom: 4px;
            }

            .ui-value {
                font-size: 14px;
                color: #00b359;
            }

            .ui-value.lives {
                color: #b30000;
            }

            .ui-value.score {
                color: #ffd700;
            }

            /* Game Over Screen */
            #gameOver {
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: #1a1a1a;
                border: 4px solid;
                border-color: #8b8b8b #3a3a3a #3a3a3a #8b8b8b;
                padding: 40px 30px;
                text-align: center;
                z-index: 100;
                box-shadow: 8px 8px 0 rgba(0, 0, 0, 0.5);
            }

            #gameOver h2 {
                font-size: 24px;
                color: #b30000;
                text-shadow: 3px 3px 0 #000;
                margin-bottom: 20px;
                text-transform: uppercase;
                letter-spacing: 2px;
            }

            .final-score {
                font-size: 14px;
                color: #8b8b8b;
                margin-bottom: 25px;
            }

            .final-score span {
                color: #ffd700;
                font-size: 18px;
            }

            #gameOver button {
                padding: 15px 30px;
                background: #00b359;
                border: 4px solid;
                border-color: #008a42 #005c2b #005c2b #008a42;
                color: #fff;
                font-family: "Press Start 2P", monospace;
                font-size: 14px;
                cursor: pointer;
                box-shadow: 0 6px 0 #005c2b;
                transition: all 0.1s;
                text-transform: uppercase;
            }

            #gameOver button:hover {
                background: #00d16c;
                transform: translateY(-2px);
                box-shadow: 0 4px 0 #005c2b;
            }

            #gameOver button:active {
                transform: translateY(6px);
                box-shadow: 0 0 0 #005c2b;
            }

            /* Pixel art border pattern */
            #gameContainer::before {
                content: "";
                position: absolute;
                inset: -12px;
                background: repeating-linear-gradient(
                    45deg,
                    #2d2d2d 0px,
                    #2d2d2d 4px,
                    transparent 4px,
                    transparent 8px
                );
                pointer-events: none;
                z-index: -1;
                border: 4px solid #1a1a1a;
            }
        </style>
    </head>
    <body></body>
        <!-- ============================================
             Game UI
             ============================================
             Contains Score and Lives panels
             Positioned at top-left corner
             ============================================ -->
        <div id="gameContainer">
            <div id="ui">
                <!-- Score Panel -->
                <div class="ui-panel">
                    <div class="ui-label">SCORE</div>
                    <div class="ui-value score" id="score">0</div>
                </div>
                <!-- Lives Panel -->
                <div class="ui-panel">
                    <div class="ui-label">LIVES</div>
                    <div class="ui-value lives" id="lives">3</div>
                </div>
            </div>

            <!-- Main Game Canvas -->
            <canvas id="game" width="600" height="800"></canvas>

            <!-- Game Over Screen -->
            <div id="gameOver">
                <h2>MISSION FAILED</h2>
                <div class="final-score">
                    FINAL SCORE: <span id="finalScore">0</span>
                </div>
                <button onclick="restart()">RESTART MISSION</button>
            </div>
        </div>
    </head>
    <body>
        <div id="gameContainer">
            <div id="ui">
                <div class="ui-panel">
                    <div class="ui-label">SCORE</div>
                    <div class="ui-value score" id="score">0</div>
                </div>
                <div class="ui-panel">
                    <div class="ui-label">LIVES</div>
                    <div class="ui-value lives" id="lives">3</div>
                </div>
            </div>

            <canvas id="game" width="600" height="800"></canvas>

            <div id="gameOver">
                <h2>MISSION FAILED</h2>
                <div class="final-score">
                    FINAL SCORE: <span id="finalScore">0</span>
                </div>
                <button onclick="restart()">RESTART MISSION</button>
            </div>
        </div>

        <script>
            // ============================================
            // GAME CONSTANTS AND VARIABLES
            // ============================================
            const canvas = document.getElementById("game");
            const ctx = canvas.getContext("2d");

            // ============================================
            // Minecraft-Inspired Color Palette
            // ============================================
            // Colors match Minecraft blocks:
            // - Player: Emerald/Green (Steve skin)
            // - Bullets: Gold/Yellow
            // - Enemies: Red (Zombie/Creeper)
            // - Particles: Orange
            // - Stars: White
            // - Background: Dark green
            // ============================================
            const colors = {
                playerBody: "#00b359",
                playerDark: "#008a42",
                playerHighlight: "#66d97a",
                bullet: "#ffff00",
                bulletShadow: "#cccc00",
                enemy: "#b30000",
                enemyDark: "#8a0000",
                enemyHighlight: "#ff6666",
                enemyFace: "#000",
                particle: "#ff9800",
                star: "#ffffff",
                bgTop: "#0f1a0f",
                bgBottom: "#081008",
                terrain: "#4a3728",
            };

            let player = { x: 275, y: 720, w: 48, h: 32, speed: 6 };
            let bullets = [];
            let enemies = [];
            let particles = [];
            let stars = [];
            let score = 0;
            let lives = 3;
            let keys = {};
            let gameRunning = true;
            let frame = 0;

            // ============================================
            // Initialize Background Stars
            // ============================================
            // Creates 60 stars for parallax effect
            // Stars fall from top to bottom
            // ============================================
            for (let i = 0; i < 60; i++) {
                stars.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    size: Math.random() * 3 + 1,
                    speed: Math.random() * 2 + 0.5,
                });
            }

            // ============================================
            // Input Controls
            // ============================================
            // Arrow keys or A/D for movement
            // Spacebar to shoot
            // ============================================
            document.addEventListener("keydown", (e) => (keys[e.key] = true));
            document.addEventListener("keyup", (e) => (keys[e.key] = false));
            canvas.addEventListener("click", shoot);

            // ============================================
            // SHOOT FUNCTION
            // ============================================
            // Creates a yellow bullet from player center
            // Only fires when game is running
            // ============================================
            function shoot() {
                if (!gameRunning) return;
                bullets.push({
                    x: player.x + 24,
                    y: player.y,
                    w: 8,
                    h: 16,
                    speed: 14,
                });
            }

            // ============================================
            // SPAWN ENEMY FUNCTION
            // ============================================
            // Creates enemies at random X positions
            // Enemies spawn above screen and fall down
            // 30% chance of fast enemy type
            // ============================================
            function spawnEnemy() {
                enemies.push({
                    x: Math.random() * (canvas.width - 48),
                    y: -50,
                    w: 48,
                    h: 48,
                    speed: 2 + Math.random() * 3,
                    health: 2,
                    type: Math.random() > 0.7 ? "fast" : "normal",
                });
            }

            // ============================================
            // CREATE PARTICLES FUNCTION
            // ============================================
            // Creates explosion effect when enemies die
            // 12 particles with random directions
            // Particles have gravity applied
            // ============================================
            function createParticles(x, y, color) {
                for (let i = 0; i < 12; i++) {
                    particles.push({
                        x,
                        y,
                        vx: (Math.random() - 0.5) * 8,
                        vy: (Math.random() - 0.5) * 8,
                        life: 25,
                        color: color,
                        size: Math.random() * 4 + 2,
                    });
                }
            }

            // ============================================
            // COLLISION DETECTION
            // ============================================
            // AABB collision detection (Axis-Aligned Bounding Box)
            // Checks if two rectangles overlap
            // Used for bullets hitting enemies, enemies hitting player
            // ============================================
            function checkCollision(a, b) {
                return (
                    a.x < b.x + b.w &&
                    a.x + a.w > b.x &&
                    a.y < b.y + b.h &&
                    a.y + a.h > b.y
                );
            }

            // ============================================
            // DRAW PIXEL RECT FUNCTION
            // ============================================
            // Draws a 3D blocky rectangle with beveled edges
            // Creates Minecraft-style block effect
            // Uses 3 colors: main, dark (shadow), light (highlight)
            // ============================================
            function drawPixelRect(
                x,
                y,
                w,
                h,
                mainColor,
                darkColor,
                lightColor,
            ) {
                // Main body
                ctx.fillStyle = mainColor;
                ctx.fillRect(x, y, w, h);

                // Top highlight
                ctx.fillStyle = lightColor;
                ctx.fillRect(x, y, w, 3);
                ctx.fillRect(x, y, 3, h);

                // Bottom shadow
                ctx.fillStyle = darkColor;
                ctx.fillRect(x, y + h - 3, w, 3);
                ctx.fillRect(x + w - 3, y, 3, h);
            }

            // ============================================
            // DRAW PIXEL PLAYER (SHIP)
            // ============================================
            // Draws the player's spaceship
            // Blocky design with:
            // - Main body (emerald green)
            // - Cockpit
            // - Left and right wings
            // - Engine glow at bottom
            // ============================================
            function drawPixelPlayer() {
                const x = player.x;
                const y = player.y;
                const w = player.w;
                const h = player.h;

                // Ship body
                drawPixelRect(
                    x + 4,
                    y + 8,
                    w - 8,
                    h - 12,
                    colors.playerBody,
                    colors.playerDark,
                    colors.playerHighlight,
                );

                // Cockpit
                ctx.fillStyle = "#008a42";
                ctx.fillRect(x + 18, y + 4, 12, 8);

                // Wings
                drawPixelRect(
                    x,
                    y + 16,
                    8,
                    16,
                    colors.playerDark,
                    "#006633",
                    "#00b359",
                );
                drawPixelRect(
                    x + w - 8,
                    y + 16,
                    8,
                    16,
                    colors.playerDark,
                    "#006633",
                    "#00b359",
                );

                // Engine glow
                ctx.fillStyle = "#ff9800";
                ctx.fillRect(x + 18, y + h, 12, 4);
                ctx.fillStyle = "#ffeb3b";
                ctx.fillRect(x + 20, y + h + 4, 8, 2);
            }

            // ============================================
            // DRAW PIXEL ENEMY
            // ============================================
            // Draws enemy blocky creature ( creeper-like )
            // Features:
            - Main body (red)
            - Two white eyes with black pupils
            - Mouth with teeth
            - Beveled edges for 3D effect
            // ============================================
            function drawPixelEnemy(e) {
                const x = e.x;
                const y = e.y;
                const w = e.w;
                const h = e.h;

                // Main body (blocky like a creeper)
                drawPixelRect(
                    x + 2,
                    y + 2,
                    w - 4,
                    h - 4,
                    colors.enemy,
                    colors.enemyDark,
                    colors.enemyHighlight,
                );

                // Eyes (pixelated squares)
                ctx.fillStyle = "#fff";
                ctx.fillRect(x + 10, y + 12, 8, 8);
                ctx.fillRect(x + w - 18, y + 12, 8, 8);

                // Pupils
                ctx.fillStyle = "#000";
                ctx.fillRect(x + 14, y + 16, 4, 4);
                ctx.fillRect(x + w - 14, y + 16, 4, 4);

                // Mouth/teeth
                ctx.fillStyle = "#000";
                ctx.fillRect(x + 14, y + 30, 20, 4);
                ctx.fillRect(x + 14, y + 30, 4, 4);
                ctx.fillRect(x + 22, y + 30, 4, 4);
                ctx.fillRect(x + 30, y + 30, 4, 4);
            }

            // ============================================
            // UPDATE FUNCTION
            // ============================================
            // Game logic - runs before each frame
            // Updates:
            // - Player position
            // - Bullet positions
            // - Enemy positions and spawning
            // - Star movement
            // - Collision detection
            // ============================================
            function update() {
                if (!gameRunning) return;

                frame++;

                // Move player
                if (keys["ArrowLeft"] || keys["a"])
                    player.x = Math.max(0, player.x - player.speed);
                if (keys["ArrowRight"] || keys["d"])
                    player.x = Math.min(
                        canvas.width - player.w,
                        player.x + player.speed,
                    );
                if (keys[" "]) shoot();

                // Move bullets
                bullets = bullets.filter((b) => {
                    b.y -= b.speed;
                    return b.y > -20;
                });

                // Spawn enemies
                if (frame % 60 === 0) spawnEnemy();

                // Update stars
                stars.forEach((star) => {
                    star.y += star.speed;
                    if (star.y > canvas.height) {
                        star.y = 0;
                        star.x = Math.random() * canvas.width;
                    }
                });

                // Move enemies
                enemies.forEach((e) => {
                    e.y += e.speed;

                    // Check bullet collision
                    bullets.forEach((b, bi) => {
                        if (checkCollision(b, e)) {
                            bullets.splice(bi, 1);
                            e.health--;
                            if (e.health <= 0) {
                                createParticles(
                                    e.x + e.w / 2,
                                    e.y + e.h / 2,
                                    colors.particle,
                                );
                                score += 10;
                                document.getElementById("score").textContent =
                                    score;
                                e.dead = true;
                            }
                        }
                    });

                    // Check player collision
                    if (checkCollision(e, player)) {
                        createParticles(
                            player.x + player.w / 2,
                            player.y + player.h / 2,
                            "#ff0",
                        );
                        lives--;
                        document.getElementById("lives").textContent = lives;
                        e.dead = true;

                        if (lives <= 0) {
                            gameRunning = false;
                            document.getElementById("finalScore").textContent =
                                score;
                            document.getElementById("gameOver").style.display =
                                "block";
                        }
                    }
                });

                enemies = enemies.filter(
                    (e) => !e.dead && e.y < canvas.height + 50,
                );

                // ============================================
                // UPDATE PARTICLES
                // ============================================
                // Move particles with gravity
                // Remove particles when expired
                // ============================================
                particles = particles.filter((p) => {
                    p.x += p.vx;
                    p.y += p.vy;
                    p.vy += 0.2; // gravity
                    p.life--;
                    return p.life > 0;
                });
            }

            // ============================================
            // DRAW FUNCTION
            // ============================================
            // Renders everything to canvas
            // Order matters (layering):
            // 1. Background
            // 2. Stars
            // 3. Player
            // 4. Bullets
            // 5. Enemies
            // 6. Particles
            // ============================================
            function draw() {
                // Clear with gradient background
                const gradient = ctx.createLinearGradient(
                    0,
                    0,
                    0,
                    canvas.height,
                );
                gradient.addColorStop(0, colors.bgTop);
                gradient.addColorStop(1, colors.bgBottom);
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                // ============================================
                // DRAW STARS
                // ============================================
                // Simple square pixels for stars
                // ============================================
                ctx.fillStyle = colors.star;
                stars.forEach((star) => {
                    ctx.fillRect(star.x, star.y, star.size, star.size);
                });

                // Draw player
                drawPixelPlayer();

                // Draw bullets
                bullets.forEach((b) => {
                    ctx.fillStyle = colors.bullet;
                    ctx.fillRect(b.x, b.y, b.w, b.h);
                    ctx.fillStyle = colors.bulletShadow;
                    ctx.fillRect(b.x + 2, b.y + 2, b.w - 4, b.h - 4);
                });

                // ============================================
                // DRAW ENEMIES
                // ============================================
                // Render each enemy
                // ============================================
                enemies.forEach((e) => {
                    drawPixelEnemy(e);
                });

                // Draw particles
                particles.forEach((p) => {
                    ctx.fillStyle = p.color;
                    ctx.globalAlpha = p.life / 25;
                    ctx.fillRect(p.x, p.y, p.size, p.size);
                    ctx.globalAlpha = 1;
                });
            }

            // ============================================
            // GAME LOOP
            // ============================================
            // Main game loop
            // Updates logic then draws everything
            // Runs at ~60 FPS via requestAnimationFrame
            // ============================================
            function gameLoop() {
                update();
                draw();
                requestAnimationFrame(gameLoop);
            }

            // ============================================
            // RESTART FUNCTION
            // ============================================
            // Resets all game state when player loses
            // Resets:
            // - Player position
            // - Score to 0
            // - Lives to 3
            // - Clears bullets, enemies, particles
            // Hides game over screen
            // ============================================
            function restart() {
                player = { x: 275, y: 720, w: 48, h: 32, speed: 6 };
                bullets = [];
                enemies = [];
                particles = [];
                score = 0;
                lives = 3;
                gameRunning = true;
                frame = 0;
                document.getElementById("score").textContent = score;
                document.getElementById("lives").textContent = lives;
                document.getElementById("gameOver").style.display = "none";
            }

            // Start the game
            gameLoop();
        </script>
    </body>
</html>
